<!DOCTYPE html>
<html lang="en" ng-app="selectApp">
<head>
	<meta charset="UTF-8">
	<title></title>
  <script src="lib/angular.min.js" type="text/javascript"></script>
  <script src="lib/angular-animate.js" type="text/javascript"></script>
  <script src="lib/jquery-2.1.4.min.js" type="text/javascript"></script>
  <style>
    *{
      padding: 0;
      margin: 0;
    }
    body {
      margin: 0;
    }
    .modalground{
      position: absolute;
      left: 0;
      right: 0;
      top: 0;
      bottom: 0;
      width: 100%;
      height: 100%;
      background: black;
      opacity: 0.3;
    }
    .windowContent{
      width: 960px;
      height: 600px;
      border-radius: 5px;
      background-color: rgb(255,255,255);
      position: relative;
      margin: 0 auto;
      top: 80px;
      z-index: 999;
    }
  </style>
</head>
<body ng-controller="selectController">

</body>
<script>
  angular.module('selectApp',["template/window.html"])
    .controller('selectController',['$scope','model',function ($scope,model) {
      model.open({
        backgroundStyle:'modalground',
        templateUrl:'template/window.html',
        className:'windowContent'
      })
    }])
    .factory('model',['$animate','$compile','$rootScope','$document','$timeout','$q', function ($animate, $compile, $rootScope, $document, $timeout, $q) {
      var body=$document.find('body').eq(0);
      var modelStack={
        open: function (modalInstance) {
          /*下面是背景*/
          var newRoot=$rootScope.$new(true);
          var backGround=angular.element('<div ><div>');
          backGround.attr({
            class:modalInstance.backgroundStyle,
          });
          var backGroundLink=$compile(backGround)(newRoot);
          body.append(backGroundLink);
          /*下面是对话框*/
          var modalContent=angular.element('<div model-window="modal-window"></div>');
          modalContent.attr({
            'template-url':modalInstance.templateUrl,
            'size':modalInstance.size,
            'class':modalInstance.className
          });
          var modalContentLink=$compile(modalContent)(newRoot);
          body.append(modalContentLink);
        }
      };
      return modelStack;
    }])
    .directive('modelWindow',['$animate','$q','$injector', function ($animate, $q,$injector) {
      return{
        restrict:'EA',
        replace:true,
        templateUrl: function (tElement, tAttrs) {
          return tAttrs.templateUrl;
        },
        link: function (scope,element,attr) {

        }
      }
    }]);
  /*缓存*/
  angular.module('template/window.html',[])
    .run(['$templateCache', function ($templateCache) {
      $templateCache.put('template/window.html','<div>' +
        '<h1>tittle</h1>' +
        '<p ng-click="func()">123123</p>' +
        '</div>')
    }])
</script>
</html>
